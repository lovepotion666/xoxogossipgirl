<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>xoxo gossip girl</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/sf-pro-display">
<style>
:root { --pink: #ff4fd8; --hot: #ff1aa6; --glass: rgba(255, 255, 255, 0.05); --border: rgba(255, 255, 255, 0.12); --bg: #000; }
* { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; font-family: 'SF Pro Display', 'SF Arabic', -apple-system, sans-serif; }
body { background: #000; color: #fff; overflow-x: hidden; background-image: radial-gradient(circle at 50% -20%, #2b1445 0%, #000 60%); background-attachment: fixed; }

/* --- iOS LIQUID HEADER --- */
header { 
    position: sticky; top: 0; z-index: 1000; padding: 25px 20px;
    background: rgba(10, 10, 10, 0.7); backdrop-filter: blur(40px) saturate(180%); -webkit-backdrop-filter: blur(40px) saturate(180%);
    border-bottom: 0.5px solid var(--border); display: flex; flex-direction: column; align-items: center;
}
.logo { font-size: 30px; font-weight: 900; letter-spacing: -1.5px; }
.logo span { color: var(--pink); text-shadow: 0 0 20px rgba(255, 79, 216, 0.4); }
.subtitle { font-size: 11px; font-weight: 800; letter-spacing: 3px; margin-top: 8px; color: #00ffcc; text-transform: uppercase; }

.vault-btn { 
    position: absolute; right: 20px; top: 28px; background: var(--glass); border: 0.5px solid var(--border);
    padding: 8px 16px; border-radius: 40px; font-size: 10px; font-weight: 900; cursor: pointer; transition: 0.2s;
}
.glow-badge { background: var(--pink); color: #000; font-size: 10px; padding: 2px 8px; border-radius: 10px; margin-left: 6px; box-shadow: 0 0 15px var(--pink); display: none; }

/* --- LIQUID CONTAINERS --- */
.container { max-width: 620px; margin: 20px auto; padding: 0 20px 140px; }
.glass-bubble { 
    background: var(--glass); backdrop-filter: blur(60px); -webkit-backdrop-filter: blur(60px);
    border: 0.6px solid var(--border); border-radius: 35px; margin-bottom: 25px; 
    box-shadow: 0 20px 40px rgba(0,0,0,0.3); transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
}
.composer { padding: 30px; }
textarea { 
    width: 100%; background: rgba(255,255,255,0.03); border: 0.5px solid var(--border); 
    border-radius: 22px; padding: 20px; color: #fff; font-size: 18px; outline: none; margin-bottom: 20px; resize: none;
}
.btn-row { display: flex; gap: 12px; }
.btn { 
    flex: 1; padding: 18px; border-radius: 24px; font-weight: 900; font-size: 15px; 
    cursor: pointer; border: none; display: flex; align-items: center; justify-content: center; transition: 0.2s;
}
.btn-media { background: rgba(255,255,255,0.08); color: #fff; border: 0.5px solid var(--border); }
.btn-drop { background: linear-gradient(135deg, var(--pink), var(--hot)); color: #fff; box-shadow: 0 10px 25px rgba(255,79,216,0.3); }
.btn:active { transform: scale(0.96); opacity: 0.8; }

/* --- SPOTTED FEED --- */
.post-card { padding: 28px; cursor: pointer; }
.post-card:active { background: rgba(255,255,255,0.03); }
.avatar { width: 44px; height: 44px; border-radius: 50%; border: 2px solid var(--pink); display: flex; align-items: center; justify-content: center; color: var(--pink); font-weight: 900; margin-bottom: 18px; }
.post-img { width: 100%; border-radius: 24px; margin-bottom: 18px; border: 0.5px solid var(--border); }

/* --- VERSIONING --- */
.v-tag { position: fixed; bottom: 20px; right: 20px; font-size: 10px; opacity: 0.4; font-weight: 900; letter-spacing: 1px; }
#spottedGlow { background: #00ff88; color: #000; padding: 4px 12px; border-radius: 20px; font-size: 10px; font-weight: 900; box-shadow: 0 0 20px #00ff88; margin-left: 15px; display: none; }

.modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(40px); z-index: 2000; display: none; align-items: center; justify-content: center; padding: 20px; }
#prevBox { display: none; margin-bottom: 20px; position: relative; border-radius: 20px; overflow: hidden; }
</style>
</head>
<body>

<header>
    <div class="vault-btn" onclick="document.getElementById('auth').style.display='flex'">VAULT <span id="vCount" class="glow-badge">0</span></div>
    <div class="logo">xoxo <span>gossip girl</span></div>
    <div class="subtitle">happy christmas ðŸŽ„</div>
</header>

<div class="container">
    <div class="glass-bubble composer">
        <div id="prevBox"><img id="imgP" style="width:100%;"><p onclick="clearMedia()" style="color:var(--pink); text-align:center; padding:10px; font-weight:900; cursor:pointer;">REMOVE PHOTO</p></div>
        <textarea id="tipIn" placeholder="I'm listening..."></textarea>
        <input type="file" id="fileIn" accept="image/*" style="display:none" onchange="processMedia(this)">
        <div class="btn-row">
            <button class="btn btn-media" onclick="document.getElementById('fileIn').click()">MEDIA</button>
            <button class="btn btn-drop" id="dropBtn">DROP TIP</button>
        </div>
    </div>

    <h2 style="margin: 40px 0 25px 10px; font-size: 28px; font-weight: 900; display: flex; align-items: center;">Spotted! <span id="spottedGlow">NEW</span></h2>
    <div id="feed"></div>
</div>

<div id="auth" class="modal">
    <div class="glass-bubble" style="padding: 40px; text-align: center; width: 340px;">
        <h2 style="margin-bottom:25px;">Passcode</h2>
        <input type="password" id="passIn" style="width:100%; padding:18px; border-radius:18px; background:#000; border:1px solid #333; color:#fff; text-align:center; margin-bottom:25px; outline:none; font-size:24px;">
        <button class="btn btn-drop" style="width:100%" onclick="unlock()">UNLOCK</button>
    </div>
</div>

<div class="v-tag">v2.5</div>

<script>
const firebaseConfig = { 
    apiKey: "AIzaSyCTdVcJspQxXiq_Kd7ImL32xWsjv0HgENE", 
    authDomain: "gossip-girl-4c9f2.firebaseapp.com", 
    projectId: "gossip-girl-4c9f2", 
    databaseURL: "https://gossip-girl-4c9f2-default-rtdb.firebaseio.com"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
let mediaData = null;

function processMedia(input) {
    if (input.files && input.files[0]) {
        const r = new FileReader();
        r.onload = e => {
            const img = new Image(); img.src = e.target.result;
            img.onload = () => {
                const cvs = document.createElement('canvas'); const ctx = cvs.getContext('2d');
                const max = 800; let w = img.width, h = img.height;
                if(w > max) { h *= max/w; w = max; }
                cvs.width = w; cvs.height = h; ctx.drawImage(img,0,0,w,h);
                mediaData = cvs.toDataURL('image/jpeg', 0.7);
                document.getElementById('imgP').src = mediaData;
                document.getElementById('prevBox').style.display = 'block';
            };
        };
        r.readAsDataURL(input.files[0]);
    }
}
function clearMedia() { mediaData = null; document.getElementById('prevBox').style.display='none'; }

document.getElementById('dropBtn').onclick = function() {
    const val = document.getElementById('tipIn').value.trim();
    if(!val && !mediaData) return;
    this.innerText = "DROPPING..."; this.disabled = true;
    db.ref('tips').push({ text: val, image: mediaData, date: Date.now() }).then(() => {
        document.getElementById('tipIn').value = ''; clearMedia();
        this.innerText = "DROP TIP"; this.disabled = false;
        alert('Received. ðŸ’‹');
    });
};

db.ref('tips').on('value', s => {
    const n = s.numChildren();
    document.getElementById('vCount').innerText = n;
    document.getElementById('vCount').style.display = n > 0 ? 'inline-block' : 'none';
});

let postCount = localStorage.getItem('pCount') || 0;
db.ref('posts').on('value', s => {
    const feed = document.getElementById('feed'); feed.innerHTML = '';
    const data = s.val(); 
    if(data) {
        const keys = Object.keys(data).reverse();
        if(keys.length > postCount && postCount > 0) document.getElementById('spottedGlow').style.display = 'inline-block';
        keys.forEach(k => {
            const p = data[k];
            const div = document.createElement('div'); div.className = 'glass-bubble post-card';
            div.onclick = () => { localStorage.setItem('currentPostId', k); location.href='comments.html'; };
            let img = p.image ? `<img src="${p.image}" class="post-img">` : '';
            div.innerHTML = `<div class="avatar">?</div>${img}<div style="font-size:18px; line-height:1.6;">${p.text}</div>`;
            feed.appendChild(div);
        });
        localStorage.setItem('pCount', keys.length);
    }
});

function unlock() { if(document.getElementById('passIn').value==='ykuluvmexoxogg2026xxx'){sessionStorage.setItem('admin_auth','true'); location.href='received-tips.html';}else{alert('Denied.');}}
</script>
</body>
</html>
