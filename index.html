<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>xoxo gossip girl | Titanium Obsidian</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/sf-pro-display">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">

<style>
:root {
    --pink: #ff4fd8;
    --hot: #ff1aa6;
    --glass: rgba(255, 255, 255, 0.04);
    --border: rgba(255, 255, 255, 0.1);
    --inner-glow: inset 0 1px 1px rgba(255, 255, 255, 0.15);
    --bg: #050505;
}

* { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

body {
    background-color: var(--bg);
    background-image: 
        radial-gradient(circle at 20% 0%, #2b1445 0%, transparent 40%),
        radial-gradient(circle at 80% 100%, #1b0f33 0%, transparent 40%);
    background-attachment: fixed;
    color: #fff;
    font-family: 'SF Pro Display', 'Noto Sans Arabic', -apple-system, sans-serif;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
}

/* --- ADAPTIVE HEADER --- */
header {
    position: sticky; top: 0; z-index: 1000;
    padding: 20px;
    background: rgba(5, 5, 5, 0.1);
    transition: background 0.4s, backdrop-filter 0.4s;
    display: flex; flex-direction: column; align-items: center;
}
header.scrolled {
    background: rgba(5, 5, 5, 0.6);
    backdrop-filter: blur(40px) saturate(180%);
    -webkit-backdrop-filter: blur(40px) saturate(180%);
    border-bottom: 0.5px solid var(--border);
}

.logo { font-size: 28px; font-weight: 900; letter-spacing: -1.8px; filter: drop-shadow(0 0 12px rgba(255, 79, 216, 0.3)); }
.logo span { color: var(--pink); }

/* --- NAVIGATION PILL --- */
.admin-trigger {
    position: absolute; right: 20px; top: 22px;
    background: var(--glass); border: 1px solid var(--border);
    padding: 8px 16px; border-radius: 40px; font-size: 11px; font-weight: 900;
    cursor: pointer; transition: 0.3s; display: flex; align-items: center; gap: 8px;
}
.admin-trigger:active { transform: scale(0.92); background: var(--pink); color: #000; }
.badge {
    background: var(--pink); color: #000; font-size: 10px; padding: 2px 6px; 
    border-radius: 6px; box-shadow: 0 0 10px var(--pink); display: none;
}

/* --- COMPOSER & CARDS --- */
.container { max-width: 620px; margin: 20px auto; padding: 0 20px 100px; }

.glass-panel {
    background: var(--glass);
    backdrop-filter: blur(50px) saturate(210%);
    -webkit-backdrop-filter: blur(50px) saturate(210%);
    border: 1px solid var(--border);
    border-radius: 32px;
    box-shadow: 0 30px 60px rgba(0,0,0,0.4), var(--inner-glow);
    margin-bottom: 25px;
    overflow: hidden;
}

.composer { padding: 25px; }
textarea {
    width: 100%; background: rgba(0,0,0,0.4); border: 1px solid var(--border);
    border-radius: 20px; padding: 18px; color: #fff; font-size: 17px;
    outline: none; transition: 0.3s; margin-bottom: 18px; resize: none;
    font-family: inherit;
}
textarea:focus { border-color: var(--pink); background: rgba(0,0,0,0.6); }

/* --- HAPTIC BUTTONS --- */
.btn-row { display: flex; gap: 12px; }
.btn {
    flex: 1; padding: 18px; border-radius: 24px; font-weight: 900; font-size: 14px;
    cursor: pointer; border: none; transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
    display: flex; align-items: center; justify-content: center;
}
.btn-ghost { background: rgba(255,255,255,0.06); color: #fff; border: 1px solid var(--border); }
.btn-primary { 
    background: linear-gradient(135deg, var(--pink), var(--hot)); 
    color: #fff; box-shadow: 0 12px 24px rgba(255, 79, 216, 0.3);
}
.btn:active { transform: scale(0.96) brightness(1.2); }
.btn:disabled { opacity: 0.5; filter: grayscale(1); cursor: default; }

/* --- FEED STYLING --- */
.post-item {
    padding: 26px; cursor: pointer;
    animation: slideUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) both;
}
@keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

.post-user { display: flex; align-items: center; gap: 12px; margin-bottom: 18px; }
.p-avatar {
    width: 44px; height: 44px; border-radius: 50%;
    background: #000; border: 1.5px solid var(--pink);
    display: flex; align-items: center; justify-content: center;
    color: var(--pink); font-weight: 900;
}

.section-head { 
    margin: 50px 0 25px 10px; font-size: 24px; font-weight: 900; 
    display: flex; align-items: center; gap: 12px; letter-spacing: -1.2px;
}
.glow-dot { 
    width: 12px; height: 12px; background: var(--pink); border-radius: 50%; 
    box-shadow: 0 0 15px var(--pink); animation: breathe 2s infinite; display: none;
}
@keyframes breathe { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.4); opacity: 0.5; } }

/* --- AUTH MODAL --- */
.modal {
    position: fixed; inset: 0; background: rgba(0,0,0,0.9);
    backdrop-filter: blur(20px); z-index: 2000;
    display: none; align-items: center; justify-content: center; padding: 20px;
}
.modal-content { width: 100%; max-width: 340px; text-align: center; }

.pass-input {
    width: 100%; padding: 20px; border-radius: 20px; background: #000;
    border: 1px solid #333; color: #fff; text-align: center;
    font-size: 24px; letter-spacing: 6px; margin-bottom: 20px; outline: none;
}

.version-label { position: fixed; bottom: 20px; right: 20px; font-size: 10px; opacity: 0.2; font-weight: 900; }
</style>
</head>
<body>

<header id="mainHeader">
    <div class="admin-trigger" onclick="toggleModal(true)">
        VAULT <span id="adminCount" class="badge">0</span>
    </div>
    <div class="logo" onclick="window.scrollTo({top:0, behavior:'smooth'})">xoxo <span>gossip girl</span></div>
    <div style="font-size:9px; letter-spacing:3px; opacity:0.4; margin-top:5px; font-weight:800;">UPPER EAST SIDE v6.0</div>
</header>

<div class="container">
    <div class="glass-panel composer">
        <h3 style="margin-bottom:15px; font-weight:900;">Spill the Secret</h3>
        <textarea id="tipIn" rows="3" placeholder="I see everything..."></textarea>
        <div class="btn-row">
            <button class="btn btn-ghost" onclick="alert('Media server encrypted. ðŸ’‹')">MEDIA</button>
            <button class="btn btn-primary" id="dropBtn">DROP TIP</button>
        </div>
    </div>

    <div class="section-head">
        Spotted! <div id="newPostGlow" class="glow-dot"></div>
    </div>

    <div id="feedList"></div>
    
    <p style="text-align:center; color:var(--pink); font-style:italic; margin-top:60px; opacity:0.5; font-size:14px;">you know you love me, xoxo ðŸ’‹</p>
</div>

<div class="version-label">TITANIUM OBSIDIAN v6.0</div>

<div id="authModal" class="modal">
    <div class="glass-panel modal-content" style="padding: 40px 30px;">
        <h2 style="margin-bottom:20px; font-weight:900;">Identity Check</h2>
        <input type="password" id="passIn" placeholder="â€¢â€¢â€¢â€¢" class="pass-input">
        <button class="btn btn-primary" style="width:100%" onclick="validateAdmin()">UNLOCK</button>
        <p style="margin-top:25px; font-size:11px; opacity:0.5; cursor:pointer; font-weight:800;" onclick="toggleModal(false)">GO BACK</p>
    </div>
</div>

<script>
// --- STABILITY CONFIG ---
const firebaseConfig = { apiKey: "AIzaSyCTdVcJspQxXiq_Kd7ImL32xWsjv0HgENE", authDomain: "gossip-girl-4c9f2.firebaseapp.com", projectId: "gossip-girl-4c9f2", storageBucket: "gossip-girl-4c9f2.firebasestorage.app", messagingSenderId: "206020058212", appId: "1:206020058212:web:fb7c70aa1e3765e6691371" };
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// --- HEADER TRANSITION ---
window.onscroll = () => {
    const head = document.getElementById('mainHeader');
    if(window.scrollY > 20) head.classList.add('scrolled');
    else head.classList.remove('scrolled');
};

// --- DATA: DROP TIP ---
document.getElementById('dropBtn').onclick = function() {
    const val = document.getElementById('tipIn').value.trim();
    if(!val) return;

    this.disabled = true;
    this.innerText = "DROPPING...";

    db.ref('tips').push({ text: val, date: Date.now() }).then(() => {
        document.getElementById('tipIn').value = '';
        this.disabled = false;
        this.innerText = "DROP TIP";
        alert('Received. If it\'s juicy, you\'ll see it soon. ðŸ’‹');
    });
};

// --- DATA: ADMIN BADGE ---
db.ref('tips').on('value', snap => {
    const count = snap.numChildren();
    const badge = document.getElementById('adminCount');
    badge.innerText = count;
    badge.style.display = count > 0 ? 'inline-block' : 'none';
});

// --- DATA: LIVE FEED ---
let lastReadPost = localStorage.getItem('gg_last_read') || 0;

db.ref('posts').on('value', snap => {
    const feed = document.getElementById('feedList');
    feed.innerHTML = '';
    const data = snap.val();
    let hasNew = false;

    if(data) {
        Object.keys(data).reverse().forEach(key => {
            const post = data[key];
            if(post.date > lastReadPost) hasNew = true;

            const card = document.createElement('div');
            card.className = 'glass-panel post-item';
            card.onclick = () => {
                localStorage.setItem('currentPostId', key);
                location.href = 'comments.html';
            };
            card.innerHTML = `
                <div class="post-user">
                    <div class="p-avatar">?</div>
                    <div style="font-weight:900; font-size:13px; opacity:0.8; letter-spacing:0.5px;">ANONYMOUS SOURCE</div>
                </div>
                <div style="font-size:17px; line-height:1.6; color:rgba(255,255,255,0.95);">${post.text}</div>
            `;
            feed.appendChild(card);
        });
    } else {
        feed.innerHTML = '<div style="text-align:center; opacity:0.2; padding:60px;">Silence is deafening...</div>';
    }
    document.getElementById('newPostGlow').style.display = hasNew ? 'block' : 'none';
});

// --- UI HELPERS ---
function toggleModal(show) {
    document.getElementById('authModal').style.display = show ? 'flex' : 'none';
    if(show) document.getElementById('passIn').focus();
}

function validateAdmin() {
    const pin = document.getElementById('passIn').value;
    if(pin === 'ykuluvmexoxogg2026xxx') {
        sessionStorage.setItem('admin_auth', 'true');
        location.href = 'received-tips.html';
    } else {
        alert('Access Denied.');
        document.getElementById('passIn').value = '';
    }
}

// Update "Read" status on leave
window.onbeforeunload = () => {
    localStorage.setItem('gg_last_read', Date.now());
};
</script>
</body>
</html>
